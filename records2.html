<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin ‚Äì Customer Spending</title>

<style>
:root {
    --bg:#f5f7fa; --card:#fff; --text:#1f2937;
    --border:#e5e7eb; --primary:#111827; --hover:#f9fafb;
}
body.dark {
    --bg:#0f172a; --card:#020617; --text:#e5e7eb;
    --border:#1e293b; --primary:#e5e7eb; --hover:#020617;
}
body {
    margin:0; font-family:Inter,Segoe UI,Arial;
    background:var(--bg); color:var(--text);
    padding:20px;
}
.container { max-width:1000px; margin:auto; }
.card {
    background:var(--card); padding:22px;
    border-radius:14px; box-shadow:0 12px 30px rgba(0,0,0,.08);
    margin-bottom:20px;
}
h2,h3 { margin:0 0 14px }
input,button {
    padding:12px; border-radius:8px;
    border:1px solid var(--border);
}
button {
    background:var(--primary); color:var(--bg);
    cursor:pointer;
}
button:hover { opacity:.9 }
table {
    width:100%; border-collapse:collapse;
    background:var(--card); border-radius:14px; overflow:hidden;
}
th,td { padding:14px; border-bottom:1px solid var(--border) }
thead { background:var(--primary); color:var(--bg) }
tr:hover { background:var(--hover) }
.actions button { margin-right:6px }
.hidden { display:none }
.topbar {
    display:flex; justify-content:space-between; align-items:center;
    margin-bottom:10px;
}
.error { color:#dc2626; font-size:13px }
</style>
</head>

<body>

<!-- üîê LOGIN -->
<div class="container" id="loginBox">
    <div class="card">
        <h2>Admin Login</h2>
        <input id="user" placeholder="Username"><br><br>
        <input id="pass" type="password" placeholder="Password"><br><br>
        <div id="loginError" class="error"></div>
        <button onclick="login()">Login</button>
    </div>
</div>

<!-- üìä DASHBOARD -->
<div class="container hidden" id="dashboard">

<div class="topbar">
    <h2>Admin Dashboard</h2>
    <div>
        <button onclick="toggleDark()">üåô</button>
        <button onclick="logout()">Logout</button>
    </div>
</div>

<div class="card">
    <h3>Add / Update User</h3>
    <input id="name" placeholder="Name">
    <input id="mobile" placeholder="Mobile">
    <input id="money" type="number" placeholder="Amount">
    <div id="error" class="error"></div>
    <button onclick="save()">Save</button>
</div>

<div class="card">
    <button onclick="exportCSV()">üìä Export Excel</button>
    <button onclick="window.print()">üìÑ Export PDF</button>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Name</th><th>Mobile</th><th>Total</th><th>Actions</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

</div>

<script>
/* üîê AUTH (LOCAL DEMO) */
const ADMIN = { user:"admin", pass:"nova1234" };

function login(){
    if(user.value===ADMIN.user && pass.value===ADMIN.pass){
        localStorage.setItem("auth","1");
        showDashboard();
    } else {
        loginError.innerText="Invalid login";
    }
}
function logout(){
    localStorage.removeItem("auth");
    location.reload();
}
function showDashboard(){
    loginBox.classList.add("hidden");
    dashboard.classList.remove("hidden");
}

/* üåô DARK MODE */
function toggleDark(){
    document.body.classList.toggle("dark");
    localStorage.setItem("dark",document.body.classList.contains("dark"));
}

/* üíæ DATA */
let people = JSON.parse(localStorage.getItem("people"))||{};
let editKey=null;

function render(){
    tbody.innerHTML="";
    Object.values(people).forEach(p=>{
        let r=tbody.insertRow();
        r.innerHTML=`
        <td>${p.name}</td>
        <td>${p.mobile}</td>
        <td>${p.total}</td>
        <td class="actions">
            <button onclick="edit('${p.mobile}')">Edit</button>
            <button onclick="del('${p.mobile}')">Delete</button>
        </td>`;
    });
    localStorage.setItem("people",JSON.stringify(people));
}

/* ‚ûï SAVE */
function save(){
    if(!name.value||!mobile.value||!money.value){
        error.innerText="Fill all fields";
        return;
    }
    error.innerText="";
    let m=mobile.value;
    people[m]=people[m]||{name:name.value,mobile:m,total:0};
    people[m].name=name.value;
    people[m].total+=Number(money.value);
    name.value=mobile.value=money.value="";
    render();
}

/* ‚úèÔ∏è EDIT */
function edit(m){
    let p=people[m];
    name.value=p.name;
    mobile.value=p.mobile;
}

/* ‚ùå DELETE */
function del(m){
    if(confirm("Delete?")){
        delete people[m];
        render();
    }
}

/* üìä EXPORT CSV */
function exportCSV(){
    let csv="Name,Mobile,Total\n";
    Object.values(people).forEach(p=>{
        csv+=`${p.name},${p.mobile},${p.total}\n`;
    });
    let a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([csv]));
    a.download="spending.csv";
    a.click();
}

/* üîÅ INIT */
if(localStorage.getItem("auth")) showDashboard();
if(localStorage.getItem("dark")==="true") document.body.classList.add("dark");
render();
</script>

</body>
</html>
